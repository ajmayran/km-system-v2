{% extends 'base/cmi-index.html' %} 
{% load static %} 
{% block title %}KM4AANR Forum{% endblock %} 
{% block stylesheet %}
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>

<style>
  :root {
    --primary-color: #2e7d32;
    --primary-light: #60ad5e;
    --primary-dark: #005005;
    --text-on-primary: #ffffff;
    --secondary-color: #e8f5e9;
    --text-color: #333333;
    --border-color: #dddddd;
    --hover-color: #f5f5f5;
    --success-color: #4caf50;
    --info-color: #2196f3;
    --warning-color: #ff9800;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    background-color: #f0f2f5;
    color: var(--text-color);
  }

  /* Header */
  header {
    background-color: var(--primary-color);
    color: var(--text-on-primary);
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .logo {
    display: flex;
    align-items: center;
  }

  .logo img {
    height: 40px;
    margin-right: 10px;
  }

  .logo-text {
    display: flex;
    flex-direction: column;
  }

  .logo-text h1 {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0;
  }

  .logo-text small {
    font-size: 0.75rem;
    text-transform: uppercase;
  }

  nav {
    display: flex;
    gap: 1rem;
  }

  nav a {
    color: var(--text-on-primary);
    text-decoration: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    font-weight: 500;
    transition: background-color 0.3s;
  }

  nav a:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  nav a.active {
    background-color: rgba(255, 255, 255, 0.2);
  }

  .nav-icon {
    margin-right: 5px;
  }

  .user-actions {
    display: flex;
    align-items: center;
  }

  .user-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  /* Main Container */
  .container {
    max-width: 1200px;
    margin: 3rem auto;
    padding: 0 1rem;
  }

  /* Breadcrumb */
  .breadcrumb {
    display: flex;
    align-items: center;
    margin-top: 1rem;
    font-size: 0.9rem;
    background-color: #F0F2F5;
  }

  .breadcrumb a {
    color: var(--primary-color);
    text-decoration: none;
  }

  .breadcrumb span {
    margin: 0 0.5rem;
    color: #777;
  }

  /* Post Section */
  .post-container {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    margin-bottom: 1.5rem;
  }

  .post-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
  }

  .post-title {
    font-size: 1.5rem;
    color: var(--primary-dark);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
  }

  .post-title i {
    margin-left: 0.5rem;
    color: var(--success-color);
  }

  .post-category {
    display: inline-block;
    flex-wrap: wrap;
    gap: 0.6rem;
    color: var(--primary-dark);
    border-radius: 20px;
    font-size: 0.875rem;
    margin-bottom: 0.5rem;
  }

  .post-tag {
    background-color: rgba(44, 110, 73, 0.08);
    color: var(--primary);
    padding: 5px 12px;
    border-radius: 30px;
    font-size: 0.85rem;
    text-decoration: none;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-weight: 500;
  }

  .post-tag:hover {
    background-color: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
  }

  .post-meta {
    display: flex;
    align-items: center;
    color: #777;
    font-size: 0.875rem;
  }

  .post-author {
    display: flex;
    align-items: center;
    margin-right: 1.5rem;
  }

  .author-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 0.5rem;
    overflow: hidden;
  }

  .author-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .post-date {
    display: flex;
    align-items: center;
  }

  .post-date i {
    margin-right: 0.25rem;
  }

  .post-content {
    padding: 1.5rem;
    line-height: 1.6;
  }

  .post-content p {
    margin-bottom: 1rem;
  }

  .post-content ul,
  .post-content ol {
    margin-left: 1.5rem;
    margin-bottom: 1rem;
  }

  .post-content li {
    margin-bottom: 0.5rem;
  }

  .post-content h3 {
    margin: 1.5rem 0 0.75rem;
    color: var(--primary-dark);
  }

  .topic-points {
    margin: 1rem 0;
  }

  .topic-item {
    display: flex;
    align-items: flex-start;
    margin-bottom: 0.75rem;
  }

  .topic-item i {
    color: var(--success-color);
    margin-right: 0.5rem;
    margin-top: 0.25rem;
  }

  /* Post Actions */
  .post-actions {
    display: flex;
    padding: 1rem 1.5rem;
    border-top: 1px solid var(--border-color);
    background-color: #f9f9f9;
  }

  .action-button {
    display: flex;
    align-items: center;
    background: none;
    border: none;
    padding: 0.5rem 1rem;
    margin-right: 1rem;
    cursor: pointer;
    color: #555;
    font-size: 0.9rem;
    border-radius: 4px;
    transition: background-color 0.2s;
  }

  .action-button:hover {
    background-color: var(--hover-color);
  }

  .action-button i {
    margin-right: 0.5rem;
  }

  .action-button.liked {
    color: var(--primary-color);
  }

  .share-dropdown {
    position: relative;
  }

  .share-menu {
    position: absolute;
    bottom: 100%;
    left: 0;
    background-color: white;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    padding: 0.5rem 0;
    min-width: 150px;
    z-index: 100;
    display: none;
  }

  .share-menu.active {
    display: block;
  }

  .share-menu a {
    display: flex;
    align-items: center;
    padding: 0.5rem 1rem;
    color: var(--text-color);
    text-decoration: none;
    transition: background-color 0.2s;
  }

  .share-menu a:hover {
    background-color: var(--hover-color);
  }

  .share-menu i {
    margin-right: 0.5rem;
    width: 20px;
    text-align: center;
  }

  /* Comments Section */
  .comments-section {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    overflow: hidden;
  }

  .comments-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .comments-header h3 {
    font-size: 1.25rem;
    color: var(--primary-dark);
  }

  .comments-count {
    background-color: var(--secondary-color);
    color: var(--primary-dark);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.875rem;
  }

  .comment-form {
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
  }

  .comment-input {
    display: flex;
    gap: 1rem;
  }

  .comment-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .comment-textarea {
    flex-grow: 1;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 0.75rem;
    resize: none;
    font-size: 0.9rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .comment-textarea:focus {
    border-color: var(--primary-color);
  }

  .comment-actions {
    display: flex;
    justify-content: flex-end;
    margin-top: 0.5rem;
  }

  .submit-comment {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s;
  }

  .submit-comment:hover {
    background-color: var(--primary-dark);
  }

  .comments-list {
    padding: 0 1.5rem;
  }

  .comment {
    padding: 1.5rem 0;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    gap: 1rem;
  }

  .comment:last-child {
    border-bottom: none;
  }

  .comment-body {
    flex-grow: 1;
  }

  .comment-author {
    font-weight: 500;
    margin-bottom: 0.25rem;
  }

  .comment-text {
    margin-bottom: 0.5rem;
    line-height: 1.5;
    font-size: 0.95rem;
  }

  .comment-meta {
    display: flex;
    color: #777;
    font-size: 0.8rem;
  }

  .comment-date {
    margin-right: 1rem;
  }

  .comment-reply {
    color: var(--primary-color);
    cursor: pointer;
  }

  .reply-form {
    margin-top: 1rem;
    margin-left: 2.5rem;
    display: none;
  }

  .reply-form.active {
    display: block;
  }

  .nested-comment {
    margin-top: 1rem;
    margin-left: 2.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    header {
      padding: 1rem;
    }

    .logo-text h1 {
      font-size: 1.2rem;
    }

    nav a {
      padding: 0.5rem;
    }

    .post-header,
    .post-content {
      padding: 1rem;
    }

    .post-title {
      font-size: 1.25rem;
    }

    .post-meta {
      flex-direction: column;
      align-items: flex-start;
    }

    .post-author {
      margin-bottom: 0.5rem;
    }

    .post-actions {
      flex-wrap: wrap;
    }
  }
</style>
{% endblock %} {% block content %}
<div class="main-content">
  <div class="container">

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'appCmi:home' %}"><i class="fas fa-home"></i> Home</a>
        <span>/</span>
        <a href="{% url 'appCmi:cmi-forum' %}">Forum</a>
        <span>/</span>
        {% for commodity in display_forum.commodity_id.all %}
            <a href="#">{{ commodity }}</a>
            {% if not forloop.last %} & {% endif %}
        {% endfor %}
    </div>
    

    <!-- Post Container -->
    <div class="post-container">
      <div class="post-header">
        <h1 class="post-title">
          {{display_forum.forum_title|upper}}
          <i class="fas fa-seedling"></i>
        </h1>
        <div class="post-category">
            {% for commodity in display_forum.commodity_id.all %}
                      <a href="#" class="post-tag">
                           {{ commodity }}
                      </a>
                  {% endfor %}
        </div>
        <div class="post-meta">
          <div class="post-author">
            <div class="author-avatar">
              <img src="/api/placeholder/100/100" alt="Author" />
            </div>
            <span>{{display_forum.author.first_name|capfirst}} {{display_forum.author.last_name|capfirst}}</span>
          </div>
          <div class="post-date">
            <i class="far fa-calendar-alt"></i>
            <span>{{display_forum.date_posted|date:"F d, Y"}}</span>
          </div>
        </div>
      </div>

      <div class="post-content">
        <p>{{display_forum.forum_question|linebreaksbr|safe}}</p>
        
      </div>

      <div class="post-actions">
        <button class="action-button" id="likeButton">
          <i class="far fa-thumbs-up"></i>
          <span>Like</span>
          <span class="like-count">(24)</span>
        </button>
        <button class="action-button" id="commentButton">
          <i class="far fa-comment-alt"></i>
          <span>Comment</span>
          <span class="comment-count">(18)</span>
        </button>
        <button class="action-button" id="saveButton">
          <i class="far fa-bookmark"></i>
          <span>Save</span>
        </button>
        <div class="share-dropdown">
          <button class="action-button" id="shareButton">
            <i class="fas fa-share-alt"></i>
            <span>Share</span>
          </button>
          <div class="share-menu" id="shareMenu">
            <a href="#" class="share-facebook">
              <i class="fab fa-facebook"></i>
              <span>Facebook</span>
            </a>
            <a href="#" class="share-twitter">
              <i class="fab fa-twitter"></i>
              <span>Twitter</span>
            </a>
            <a href="#" class="share-linkedin">
              <i class="fab fa-linkedin"></i>
              <span>LinkedIn</span>
            </a>
            <a href="#" class="share-whatsapp">
              <i class="fab fa-whatsapp"></i>
              <span>WhatsApp</span>
            </a>
            <a href="#" class="share-email">
              <i class="fas fa-envelope"></i>
              <span>Email</span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    <div class="comments-section">
      <div class="comments-header">
        <h3>Comments</h3>
        <div class="comments-count">18</div>
      </div>

      <form method="post" action="{% url 'appCmi:forum-add-comment' display_forum.slug %}" id="comment-form">
        {% csrf_token %}
        <div class="comment-form">
          <div class="comment-input">
            <div class="comment-avatar">
              {% if request.user.profile_image %}
                <img src="{{ request.user.profile_image.url }}" alt="{{ request.user.username }}">
              {% else %}
                <i class="fas fa-user"></i>
              {% endif %}
            </div>
            <textarea name="content" class="comment-textarea" placeholder="Write a comment...">{{ form.content.value|default_if_none:"" }}</textarea>
            <input type="hidden" name="parent" value="{{ form.parent.value|default_if_none:"" }}">
          </div>
          <div class="comment-actions">
            <button type="submit" class="submit-comment">Post Comment</button>
          </div>
        </div>
      </form>

      <div class="comments-list">
        <div class="comment">
          <div class="author-avatar">
            <img src="/api/placeholder/100/100" alt="Commenter" />
          </div>
          <div class="comment-body">
            <div class="comment-author">Maria Santos</div>
            <div class="comment-text">
              I've been growing Dendrocalamus asper (Giant Bamboo) for 5 years
              now in Bukidnon. It grows extremely well in our climate and has
              been profitable for construction materials. Happy to share more
              details about my experience if you're interested!
            </div>
            <div class="comment-meta">
              <div class="comment-date">March 27, 2025 · 10:15 AM</div>
              <div class="comment-reply">
                <i class="fas fa-reply"></i> Reply
              </div>
            </div>

            <div class="reply-form">
              <div class="comment-input">
                <textarea
                  class="comment-textarea"
                  placeholder="Write a reply..."
                ></textarea>
              </div>
              <div class="comment-actions">
                <button class="submit-comment reply-button">Reply</button>
              </div>
            </div>

            <div class="nested-comment">
              <div class="comment">
                <div class="author-avatar">
                  <img src="/api/placeholder/100/100" alt="Commenter" />
                </div>
                <div class="comment-body">
                  <div class="comment-author">
                    Raise WesMin
                    <span style="color: #777; font-weight: normal"
                      >(Author)</span
                    >
                  </div>
                  <div class="comment-text">
                    Thank you, Maria! I'd love to hear more about your
                    experience with Giant Bamboo. How long did it take before
                    your first harvest? Did you encounter any pests or diseases?
                  </div>
                  <div class="comment-meta">
                    <div class="comment-date">March 27, 2025 · 10:42 AM</div>
                    <div class="comment-reply">
                      <i class="fas fa-reply"></i> Reply
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="comment">
          <div class="author-avatar">
            <img src="/api/placeholder/100/100" alt="Commenter" />
          </div>
          <div class="comment-body">
            <div class="comment-author">Juan Reyes</div>
            <div class="comment-text">
              For sustainable harvesting, the key is to only harvest culms that
              are 3-5 years old. Younger ones won't have developed their full
              strength, and older ones might start deteriorating. I mark each
              new culm with paint to track its age. Also, never harvest more
              than 25% of a clump in one year.
            </div>
            <div class="comment-meta">
              <div class="comment-date">March 27, 2025 · 11:32 AM</div>
              <div class="comment-reply">
                <i class="fas fa-reply"></i> Reply
              </div>
            </div>

            <div class="reply-form">
              <div class="comment-input">
                <textarea
                  class="comment-textarea"
                  placeholder="Write a reply..."
                ></textarea>
              </div>
              <div class="comment-actions">
                <button class="submit-comment reply-button">Reply</button>
              </div>
            </div>
          </div>
        </div>

        <div class="comment">
          <div class="author-avatar">
            <img src="/api/placeholder/100/100" alt="Commenter" />
          </div>
          <div class="comment-body">
            <div class="comment-author">Elena Cruz</div>
            <div class="comment-text">
              Regarding government support, the Department of Trade and Industry
              (DTI) has a Bamboo Industry Development Program that provides
              technical assistance and sometimes financial grants for bamboo
              farmers. You should check with your local DTI office for more
              information. The Department of Agriculture sometimes has programs
              too.
            </div>
            <div class="comment-meta">
              <div class="comment-date">March 27, 2025 · 1:45 PM</div>
              <div class="comment-reply">
                <i class="fas fa-reply"></i> Reply
              </div>
            </div>

            <div class="reply-form">
              <div class="comment-input">
                <textarea
                  class="comment-textarea"
                  placeholder="Write a reply..."
                ></textarea>
              </div>
              <div class="comment-actions">
                <button class="submit-comment reply-button">Reply</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} 
{% block script %}
<script>
    // Toggle share menu
    const shareButton = document.getElementById('shareButton');
    const shareMenu = document.getElementById('shareMenu');
    const likeButton = document.getElementById('likeButton');
    const saveButton = document.getElementById('saveButton');

    shareButton.addEventListener('click', function() {
        shareMenu.classList.toggle('active');
    });

    // Close the share menu when clicking outside
    document.addEventListener('click', function(event) {
        if (!shareButton.contains(event.target) && !shareMenu.contains(event.target)) {
            shareMenu.classList.remove('active');
        }
    });

    // Like button functionality
    likeButton.addEventListener('click', function() {
        const likeIcon = likeButton.querySelector('i');
        
        if (likeIcon.classList.contains('far')) {
            likeIcon.classList.remove('far');
            likeIcon.classList.add('fas');
            likeButton.classList.add('liked');
            const countElement = likeButton.querySelector('.like-count');
            const currentCount = parseInt(countElement.textContent.replace(/[()]/g, ''));
            countElement.textContent = `(${currentCount + 1})`;
        } else {
            likeIcon.classList.remove('fas');
            likeIcon.classList.add('far');
            likeButton.classList.remove('liked');
            const countElement = likeButton.querySelector('.like-count');
            const currentCount = parseInt(countElement.textContent.replace(/[()]/g, ''));
            countElement.textContent = `(${currentCount - 1})`;
        }
    });

    // Save button functionality
    saveButton.addEventListener('click', function() {
        const saveIcon = saveButton.querySelector('i');
        
        if (saveIcon.classList.contains('far')) {
            saveIcon.classList.remove('far');
            saveIcon.classList.add('fas');
            alert('Post saved successfully!');
        } else {
            saveIcon.classList.remove('fas');
            saveIcon.classList.add('far');
            alert('Post unsaved!');
        }
    });

    // Social media share functionality (dummy for now)
    const shareLinks = document.querySelectorAll('.share-menu a');
    shareLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const platform = this.querySelector('span').textContent;
            alert(`Sharing to ${platform}... 
            This would typically open a ${platform} sharing dialog in a production environment.`);
            shareMenu.classList.remove('active');
        });
    });

    // Handle reply button clicks
    const replyButtons = document.querySelectorAll('.comment-reply');
    replyButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Close all other open reply forms first
            document.querySelectorAll('.reply-form.active').forEach(form => {
                if (form !== this.parentNode.nextElementSibling) {
                    form.classList.remove('active');
                }
            });
            
            // Toggle current reply form
            const replyForm = this.parentNode.nextElementSibling;
            replyForm.classList.toggle('active');
            
            // Focus on the textarea
            if (replyForm.classList.contains('active')) {
                replyForm.querySelector('textarea').focus();
            }
        });
    });
    
    // Handle reply submissions
    const replySubmitButtons = document.querySelectorAll('.reply-button');
    replySubmitButtons.forEach(button => {
        button.addEventListener('click', function() {
            const replyForm = this.closest('.reply-form');
            const replyText = replyForm.querySelector('textarea').value.trim();
            
            if (replyText) {
                // Create a new nested comment
                const commentBody = this.closest('.comment-body');
                
                // Check if a nested-comment container already exists
                let nestedCommentContainer = commentBody.querySelector('.nested-comment');
                
                // If not, create one
                if (!nestedCommentContainer) {
                    nestedCommentContainer = document.createElement('div');
                    nestedCommentContainer.className = 'nested-comment';
                    commentBody.appendChild(nestedCommentContainer);
                }
                
                // Create the new reply comment
                const newReply = document.createElement('div');
                newReply.className = 'comment';
                
                // Get current date and time
                const now = new Date();
                const formattedDate = `${now.toLocaleDateString()} · ${now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                
                newReply.innerHTML = `
                    <div class="author-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="comment-body">
                        <div class="comment-author">You</div>
                        <div class="comment-text">${replyText}</div>
                        <div class="comment-meta">
                            <div class="comment-date">${formattedDate}</div>
                            <div class="comment-reply"><i class="fas fa-reply"></i> Reply</div>
                        </div>
                        <div class="reply-form">
                            <div class="comment-input">
                                <textarea class="comment-textarea" placeholder="Write a reply..."></textarea>
                            </div>
                            <div class="comment-actions">
                                <button class="submit-comment reply-button">Reply</button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add the new reply to the nested comments
                nestedCommentContainer.appendChild(newReply);
                
                // Clear the textarea and hide the reply form
                replyForm.querySelector('textarea').value = '';
                replyForm.classList.remove('active');
                
                // Update comment count
                const commentCount = document.querySelector('.comment-count');
                const currentCount = parseInt(commentCount.textContent.replace(/[()]/g, ''));
                commentCount.textContent = `(${currentCount + 1})`;
                
                const commentsCount = document.querySelector('.comments-count');
                commentsCount.textContent = currentCount + 1;
                
                // Add event listener to the new reply button
                const newReplyButton = newReply.querySelector('.comment-reply');
                newReplyButton.addEventListener('click', function() {
                    const replyForm = this.parentNode.nextElementSibling;
                    replyForm.classList.toggle('active');
                    if (replyForm.classList.contains('active')) {
                        replyForm.querySelector('textarea').focus();
                    }
                });
                
                // Add event listener to the new reply submit button
                const newReplySubmitButton = newReply.querySelector('.reply-button');
                newReplySubmitButton.addEventListener('click', replySubmitHandler);
            }
        });
    });
    
    // Extract the reply submission handler to reuse it
    function replySubmitHandler() {
        const replyForm = this.closest('.reply-form');
        const replyText = replyForm.querySelector('textarea').value.trim();
        
        if (replyText) {
            // Implementation as above, but as a separate function
            // This is a simplified version for the event delegation
            alert('Reply submitted: ' + replyText);
            replyForm.querySelector('textarea').value = '';
            replyForm.classList.remove('active');
        }
    }
    
    // Comment submission
    const submitCommentButton = document.querySelector('.submit-comment:not(.reply-button)');
    const commentTextarea = document.querySelector('.comments-section > .comment-form .comment-textarea');

    submitCommentButton.addEventListener('click', function() {
        const commentText = commentTextarea.value.trim();
        
        if (commentText) {
            // Create a new comment element
            const commentsList = document.querySelector('.comments-list');
            const newComment = document.createElement('div');
            newComment.className = 'comment';
            
            // Get current date and time
            const now = new Date();
            const formattedDate = `${now.toLocaleDateString()} · ${now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
            
            newComment.innerHTML = `
                <div class="author-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="comment-body">
                    <div class="comment-author">You</div>
                    <div class="comment-text">${commentText}</div>
                    <div class="comment-meta">
                        <div class="comment-date">${formattedDate}</div>
                        <div class="comment-reply">Reply</div>
                    </div>
                </div>
            `;
            
            // Add the new comment at the top
            commentsList.insertBefore(newComment, commentsList.firstChild);
            
            // Clear the textarea
            commentTextarea.value = '';
            
            // Update comment count
            const commentCount = document.querySelector('.comment-count');
            const currentCount = parseInt(commentCount.textContent.replace(/[()]/g, ''));
            commentCount.textContent = `(${currentCount + 1})`;
            
            const commentsCount = document.querySelector('.comments-count');
            commentsCount.textContent = currentCount + 1;
        }
    });
</script>
{% endblock script %}
