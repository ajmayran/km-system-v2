{% extends 'base/admin-index.html' %} {% load embed_video_tags %} {% load static %}
{% block title %} Admin Main About {% endblock %} {% block stylesheet %}
<link rel="stylesheet" href="{% static 'style/css/admin.about.css' %}" />
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
{% load custom_tags %}

<link
  href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css"
  rel="stylesheet"
/>
{% endblock %} {% block content %}
<br />
<div class="masonry-item col-12">
  <div class="bd bgc-white">
    <div class="peers fxw-nw@lg+ ai-s">
      <div class="peer peer-greed w-70p@lg+ w-100@lg- p-20">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h3>About Main Project</h3>
         {% if not main_about_content %}
          <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#addAboutModal">
            <i class="fa fa-plus"></i> Add New
          </a>
        {% endif %}

        </div>
<!-- CSS -->
 <style>
  .about-table thead th {
    font-size: 13px;
    font-weight: bolder;
    background-color: #343a40;
    color: white;
    vertical-align: middle;
    text-align: center;
  }

  .about-table tbody td {
    font-size: 12px;
    vertical-align: middle;
    border-bottom: 1px solid #ddd;
  }

  .about-table img {
    max-width: 50px;
    max-height: 50px;
    display: block;
    margin: 0 auto;
  }

  .about-table .action-buttons {
    display: flex;
    gap: 5px;
    justify-content: center;
  }

  .about-table .btn {
    padding: 4px 8px;
    font-size: 12px;
  }

  /* Removed fixed height constraints */
  .table-container {
    overflow-y: auto;
    overflow-x: hidden;
  }

   .modal .form-group label {
    font-weight: 600;
    color: #333;
  }

  .modal .form-control {
    border-radius: 8px;
    border: 1px solid #ced4da;
    transition: border-color 0.3s;
    font-size: 14px;
  }

  .modal .form-control:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.1rem rgba(0, 123, 255, 0.25);
  }

  .modal .modal-title {
    font-weight: 600;
    color: #0C356A;
  }

  .modal-footer .btn-success {
    background-color: #198754;
    border: none;
  }

  .modal-footer .btn-secondary {
    background-color: #6c757d;
    border: none;
  }

  .modal-footer .btn:hover {
    opacity: 0.9;
  }
</style>

 <div class="table-container">
  <table class="about-table table table-bordered table-striped">
    <thead>
      <tr>
        <!-- <th>About ID</th> -->
        <!-- <th>Project Name</th>
        <th>Project Details</th> -->
        <th>Project Description</th>
        <th>Project Rationale</th>
        <th>Org Image</th>
        <!-- <th>Images w title and desc</th> -->
        <!-- <th>Objectives</th> -->
        <th>Date Created</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
    {% for item in main_about_content %}
    <tr>
      <!-- <td>{{ item.id }}</td> -->
      <td>{{ item.raise_project_desc|default:"â€”" }}</td>
      <td>{{ item.project_rationale_desc|default:"â€”" }}</td>
      <td class="text-center">
      {% if item.org_struct_image  %}
          <img src="{{ item.org_struct_image.url }}" alt="Org Structure" width="50" height="50">
          {% else %}
             <i class="fa-solid fa-image"></i>
         {% endif %}
        </td>       
      <!-- <td>{{ item.project_objectives_desc|default:"â€”"|truncatewords:10 }}</td> -->
      <td>{{ item.date_created|date:"Y-m-d H:i" }}</td>
      <td>
        <div class="action-buttons">
          <!-- <a href="#" class="btn btn-info" title="View">
            <i class="fa-solid fa-eye"></i>
          </a> -->

          <button type="button" class="btn btn-warning" data-toggle="modal"
            data-target="#editAboutModal{{ item.id }}" title="Edit">
            <i class="fa-solid fa-pen-to-square"></i>
          </button>

          <form action="{% url 'appAdmin:main-about-delete' item.id %}" method="post" style="display:inline;" class="delete-about-form">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger" title="Delete">
              <i class="fa-solid fa-trash"></i>
            </button>
          </form> 
        </div>
      </td>
    </tr>

    <!-- Edit Modal -->
    <div class="modal fade" id="editAboutModal{{ item.id }}" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <form method="post" enctype="multipart/form-data"
          action="{% url 'appAdmin:main-about-edit' item.id %}">
          {% csrf_token %}
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Edit Main Project</h5>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              {% with edit_form=edit_forms|get_item:item.id %}
                  {{ edit_form.as_p }}
              {% endwith %}                  
            </div>

            <div class="modal-footer">
              <button type="submit" class="btn btn-success">Save changes</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    {% empty %}
    <tr>
      <td colspan="11" class="text-center text-muted">
        <i class="fa-solid fa-circle-info"></i> No about project records found.
      </td>
    </tr>
    {% endfor %}
  </tbody>

  </table>

  <div class="row mt-5">
  {% for program in main_about_content %}
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-body">
        
        <!-- Side by Side Layout for Images and Objectives -->
        <div class="row">
          
          <!-- Images Section - Left Side -->
          <div class="col-md-6">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5><i class="fa fa-image"></i> Program Images</h5>
              <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addImageModal{{ program.id }}">
                <i class="fa fa-plus"></i> Add Image
              </button>
            </div>
            
            <div class="table-container">
              <table class="about-table table table-bordered table-striped">
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {% for img in program.images.all %}
                  <tr>
                    <td class="text-center">
                      {% if img.image %}
                      <img src="{{ img.image.url }}" alt="Program Image" class="img-thumbnail" style="max-width: 60px; max-height: 60px;">
                      {% else %}
                      <i class="fa fa-image text-muted"></i>
                      {% endif %}
                    </td>
                    <td>{{ img.title|default:"â€”" }}</td>
                    <td>{{ img.description|default:"â€”"|truncatewords:8 }}</td>
                    <td>
                      <div class="action-buttons">
                        
                        <button type="button" class="btn btn-warning btn-sm" data-toggle="modal" data-target="#editImageModal{{ img.id }}" title="Edit">
                          <i class="fa fa-edit"></i>
                        </button>
                        <form action="{% url 'appAdmin:image-delete' img.id %}" method="post" style="display:inline;" class="delete-form">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-danger btn-sm" title="Delete">
                            <i class="fa fa-trash"></i>
                          </button>
                        </form>
                      </div>
                    </td>
                  </tr>
                  <!-- Edit Image Modal -->
              <div class="modal fade" id="editImageModal{{ img.id }}" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                  <form method="post" enctype="multipart/form-data" action="{% url 'appAdmin:image-edit' img.id %}">
                    {% csrf_token %}
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Edit Image</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>
                      <div class="modal-body">
                        <div class="form-group">
                          <label for="edit_title_{{ img.id }}">Title</label>
                          <input type="text" class="form-control" id="edit_title_{{ img.id }}" name="title" value="{{ img.title }}">
                        </div>
                        <div class="form-group">
                          <label for="edit_description_{{ img.id }}">Description</label>
                          <textarea class="form-control" id="edit_description_{{ img.id }}" name="description" rows="3">{{ img.description }}</textarea>
                        </div>
                        <div class="form-group">
                          <label for="edit_image_{{ img.id }}">Image File</label>
                          <input type="file" class="form-control-file" id="edit_image_{{ img.id }}" name="image" accept="image/*">
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button type="submit" class="btn btn-success">Update Image</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
                  {% empty %}
                  <tr>
                    <td colspan="4" class="text-center text-muted">
                      <i class="fa fa-info-circle"></i> No images found.
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              

            </div>
          </div> 

          <!-- Objectives Section - Right Side -->
          <div class="col-md-6">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5><i class="fa fa-bullseye"></i> Program Objectives</h5>
           
              <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addObjectiveModal{{ program.id }}">
                <i class="fa fa-plus"></i> Add Objective
              </button>

            </div>
            
            <div class="table-container">
              <table class="about-table table table-bordered table-striped">
                <thead>
                  <tr>
                    <!-- <th>Title</th>
                    <th>Target</th> -->
                    <th>Objectives Bullets</th>
                    <!-- <th>Target Bullets</th> -->
                    <th>Actions</th>
                  </tr>
                </thead> 
                <tbody>
                  {% for obj in program.objectives.all %}
                  <tr>
                    <td>{{ obj.title|default:"â€”" }}</td>
                   <!--  <td>{{ obj.target|default:"â€”"|truncatewords:8 }}</td> -->
                    <!-- <td>
                      <ul class="mb-0 pl-3">
                        {% for tb in obj.title_bullets.all %}
                        <li class="text-primary">ðŸŽ¯ {{ tb.text|truncatewords:5 }}</li>
                        {% empty %}
                        <li class="text-muted">No bullets</li>
                        {% endfor %}
                      </ul>
                    </td> -->
                    <!-- <td>
                      <ul class="mb-0 pl-3">
                        {% for tgt in obj.target_bullets.all %}
                        <li class="text-success">âœ… {{ tgt.text|truncatewords:5 }}</li>
                        {% empty %}
                        <li class="text-muted">No bullets</li>
                        {% endfor %}
                      </ul>
                    </td> -->
                    <td>
                      <div class="action-buttons">
                       
                        <button type="button" class="btn btn-warning btn-sm" data-toggle="modal" data-target="#editObjectiveModal{{ obj.id }}" title="Edit">
                          <i class="fa fa-edit"></i>
                        </button>

                        <form action="{% url 'appAdmin:objective-delete' obj.id %}" method="post" style="display:inline;" class="delete-form">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-danger btn-sm" title="Delete">
                            <i class="fa fa-trash"></i>
                          </button>
                        </form>
                      </div>
                    </td>
                  </tr>
                   <!-- Updated Edit Modal Template -->
{% for obj in program.objectives.all %}
<div class="modal fade" id="editObjectiveModal{{ obj.id }}" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-md" role="document">
    <form method="post" action="{% url 'appAdmin:objective-edit' obj.id %}">
      {% csrf_token %}
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Objective</h5>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <div class="modal-body">
          <div class="form-row">
            <div class="form-group col-md-12">
              <label for="edit_objective_title_{{ obj.id }}">Objective</label>
              <input type="text" class="form-control" name="title" id="edit_objective_title_{{ obj.id }}" 
                     value="{{ obj.title }}">
            </div>
            <div class="form-group col-md-6" style="display: none;">
              <label for="edit_objective_target_{{ obj.id }}">Objective Target</label>
              <textarea class="form-control" name="target" id="edit_objective_target_{{ obj.id }}" 
                        rows="2">{{ obj.target }}</textarea>
            </div>
          </div>

          <div class="form-row">
            <!-- Title Bullets -->
            <div class="form-group col-md-12" style="display: none;">
              <label>Objective Bullets</label>
              <div id="editTitleBulletsContainer{{ obj.id }}">
                <!-- Existing title bullets -->
                {% for tb in obj.title_bullets.all %}
                <div class="input-group mb-2 bullet-input-group">
                  <input type="text" name="existing_title_bullets[{{ tb.id }}]" class="form-control" 
                         value="{{ tb.text }}" placeholder="Enter bullet">
                  <div class="input-group-append">
                    <button class="btn btn-danger remove-bullet" type="button" title="Remove this bullet">
                      <i class="fa fa-trash"></i>
                    </button>
                  </div>
                </div>
                {% endfor %}
                
                <!-- Add new title bullet input -->
                <div class="input-group mb-2 add-input-group">
                  <input type="text" name="new_title_bullets[]" class="form-control" 
                         placeholder="Enter new bullet">
                  <div class="input-group-append">
                    <button class="btn btn-success add-title-bullet" type="button" 
                            data-target="#editTitleBulletsContainer{{ obj.id }}" 
                            data-input-name="new_title_bullets[]"
                            title="Add new bullet">
                      <i class="fa fa-plus"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Target Bullets -->
            <div class="form-group col-md-6" style="display: none;">
              <label>Target Bullets</label>
              <div id="editTargetBulletsContainer{{ obj.id }}">
                <!-- Existing target bullets -->
                {% for tgt in obj.target_bullets.all %}
                <div class="input-group mb-2 bullet-input-group">
                  <input type="text" name="existing_target_bullets[{{ tgt.id }}]" class="form-control" 
                         value="{{ tgt.text }}" placeholder="Enter bullet">
                  <div class="input-group-append">
                    <button class="btn btn-danger remove-bullet" type="button" title="Remove this bullet">
                      <i class="fa fa-trash"></i>
                    </button>
                  </div>
                </div>
                {% endfor %}
                
                <!-- Add new target bullet input -->
                <div class="input-group mb-2 add-input-group">
                  <input type="text" name="new_target_bullets[]" class="form-control" 
                         placeholder="Enter new bullet">
                  <div class="input-group-append">
                    <button class="btn btn-success add-target-bullet" type="button" 
                            data-target="#editTargetBulletsContainer{{ obj.id }}" 
                            data-input-name="new_target_bullets[]"
                            title="Add new bullet">
                      <i class="fa fa-plus"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success">
            <i class="fa fa-save"></i> Update Objective
          </button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            <i class="fa fa-times"></i> Cancel
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
{% endfor %}
                  {% empty %}
                  <tr>
                    <td colspan="5" class="text-center text-muted">
                      <i class="fa fa-info-circle"></i> No objectives found.
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- MODALS FOR IMAGES -->
        
        <!-- Add Image Modal -->
        <div class="modal fade" id="addImageModal{{ program.id }}" tabindex="-1" role="dialog">
          <div class="modal-dialog" role="document">
            <form method="post" enctype="multipart/form-data" action="{% url 'appAdmin:image-add' program.id %}">
              {% csrf_token %}
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Add New Image</h5>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label for="image_title">Title</label>
                    <input type="text" class="form-control" id="image_title" name="title" required>
                  </div>
                  <div class="form-group">
                    <label for="image_description">Description</label>
                    <textarea class="form-control" id="image_description" name="description" rows="3"></textarea>
                  </div>
                  <div class="form-group">
                    <label for="image_file">Image File</label>
                    <input type="file" class="form-control-file" id="image_file" name="image" accept="image/*" required>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-success">Save Image</button>
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Add Objective Modal -->
        <div class="modal fade" id="addObjectiveModal{{ program.id }}" tabindex="-1" role="dialog">
          <div class="modal-dialog modal-md" role="document">
            <form method="post" action="{% url 'appAdmin:objective-add' program.id %}">
              {% csrf_token %}
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Add New Objective</h5>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <div class="modal-body">
                  <div class="form-row">
                    <div class="form-group col-md-12">
                      <label for="objective_title_{{ program.id }}">Objective Title</label>
                      <input type="text" class="form-control" name="title" id="objective_title_{{ program.id }}">
                    </div>
                    <div class="form-group col-md-6"  style="display: none;">
                      <label for="objective_target_{{ program.id }}">Objective Target</label>
                      <textarea class="form-control" name="target" id="objective_target_{{ program.id }}" rows="1"></textarea>
                    </div>
                  </div>

                  <div class="form-row">
                    <!-- Title Bullets -->
                    <div class="form-group col-md-12"  style="display: none;">
                      <label>Objective Bullets</label>
                      <div id="titleBulletsContainer{{ program.id }}">
                        <div class="input-group mb-2">
                          <input type="text" name="title_bullets[]" class="form-control" placeholder="Enter bullet">
                          <div class="input-group-append">
                            <button class="btn btn-success add-title-bullet" type="button" data-container-id="titleBulletsContainer{{ program.id }}">
                              <i class="fa fa-plus"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Target Bullets -->
                    <div class="form-group col-md-6" style="display: none;">
                      <label>Target Bullets</label>
                      <div id="targetBulletsContainer{{ program.id }}">
                        <div class="input-group mb-2">
                          <input type="text" name="target_bullets[]" class="form-control" placeholder="Enter bullet">
                          <div class="input-group-append">
                            <button class="btn btn-success add-target-bullet" type="button" data-container-id="targetBulletsContainer{{ program.id }}">
                              <i class="fa fa-plus"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="modal-footer">
                  <button type="submit" class="btn btn-success">Save Objective</button>
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>


      </div>
    </div>
    <hr>
  </div>
</div>

<!-- Additional CSS for better styling -->
<style>
.card {
  box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  border: 1px solid rgba(0, 0, 0, 0.125);
}

.card-header {
  background-color: #f8f9fa;
  border-bottom: 1px solid rgba(0, 0, 0, 0.125);
}

.list-group-item {
  font-size: 14px;
  padding: 0.5rem 0.75rem;
}

.action-buttons .btn {
  margin-right: 2px;
}

.action-buttons .btn:last-child {
  margin-right: 0;
}

/* Removed max-height constraint */
.table-container {
  overflow-y: auto;
}

.img-thumbnail {
  border: 1px solid #dee2e6;
  border-radius: 0.25rem;
  padding: 0.25rem;
  background-color: #fff;
}
</style>

</div>


              </td>
            </tr>
            
          </tbody>
        </table>
 {% endfor %}
      </div>
    </div>
  </div>
</div>

<!-- Add About Project Modal -->
<div class="modal fade" id="addAboutModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <form method="post" enctype="multipart/form-data" action="{% url 'appAdmin:main-about-add' %}">
      {% csrf_token %}
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add Project</h5>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          {{ form.as_p }}
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Save</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </form>
  </div>
</div>
{% include 'modal/about/upload-video.html' %} {% endblock %} {%block script %}
<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
{% if messages %} {% for message in messages %} {% if message.tags == 'success'%}
<script>
  // Display SweetAlert success message
  Swal.fire({
    icon: "success",
    title: "Success!",
    text: "{{ message }}",
  });
</script>
{% endif %} {% endfor %} {% endif %}

<script>
  $(document).ready(function () {
    $("#about-page textarea").summernote({
      height: 300,
      placeholder: "Write here...",
      toolbar: [
        ["style", ["style", "bold", "italic", "underline", "clear"]],
        ["font", ["strikethrough", "superscript", "subscript"]],
        ["fontsize", ["fontsize"]],
        ["color", ["color"]],
        ["para", ["ul", "ol", "paragraph"]],
        ["insert", ["link", "picture", "video"]],
        ["insert", ["hr"]],
        ["insert", ["table"]],
        ["misc", ["undo", "redo"]],
        ["mybutton", ["codeview"]],
        ["mybutton", ["spellchecker"]],
        ["mybutton", ["cut", "copy", "paste", "plainpaste", "wordpaste"]],
        ["mybutton", ["link", "unlink", "anchor"]],
      ],
      buttons: {
        spellchecker: function (context) {
          var ui = $.summernote.ui;
          // create button
          var button = ui.button({
            contents: '<i class="fa fa-magic"/>',
            tooltip: "Spell Checker",
            click: function () {
              context.invoke("editor.spellCheck");
            },
          });
          return button.render();
        },
      },
      styleTags: ["p", "h1", "h2", "h3", "h4", "h5", "h6"], // Include more styles as needed
      fontSizes: ["8", "9", "10", "11", "12", "14", "18", "24", "36"], // Add your desired font sizes
      colors: [
        [
          "#000000",
          "#ffffff",
          "#e0e0e0",
          "#b0b0b0",
          "#808080",
          "#404040",
          "#ff0000",
          "#ff9900",
          "#ffff00",
          "#00ff00",
          "#00ffff",
          "#0000ff",
          "#9900ff",
          "#ff00ff",
          "#f7f7f7",
          "#ccc",
        ],
      ], // Add your desired color palette
    });
  });

  $(document).ready(function () {
    $("#about-footer textarea").summernote({
      height: 300,
      placeholder: "Write here...",
      toolbar: [
        ["style", ["style", "bold", "italic", "underline", "clear"]],
        ["font", ["strikethrough", "superscript", "subscript"]],
        ["fontsize", ["fontsize"]],
        ["color", ["color"]],
        ["para", ["ul", "ol", "paragraph"]],
        ["insert", ["link", "picture", "video"]],
        ["insert", ["hr"]],
        ["insert", ["table"]],
        ["misc", ["undo", "redo"]],
        ["mybutton", ["codeview"]],
        ["mybutton", ["spellchecker"]],
        ["mybutton", ["cut", "copy", "paste", "plainpaste", "wordpaste"]],
        ["mybutton", ["link", "unlink", "anchor"]],
      ],
      buttons: {
        spellchecker: function (context) {
          var ui = $.summernote.ui;
          // create button
          var button = ui.button({
            contents: '<i class="fa fa-magic"/>',
            tooltip: "Spell Checker",
            click: function () {
              context.invoke("editor.spellCheck");
            },
          });
          return button.render();
        },
      },
      styleTags: ["p", "h1", "h2", "h3", "h4", "h5", "h6"], // Include more styles as needed
      fontSizes: ["8", "9", "10", "11", "12", "14", "18", "24", "36"], // Add your desired font sizes
      colors: [
        [
          "#000000",
          "#ffffff",
          "#e0e0e0",
          "#b0b0b0",
          "#808080",
          "#404040",
          "#ff0000",
          "#ff9900",
          "#ffff00",
          "#00ff00",
          "#00ffff",
          "#0000ff",
          "#9900ff",
          "#ff00ff",
          "#f7f7f7",
          "#ccc",
        ],
      ], // Add your desired color palette
    });
  });

  document.addEventListener("DOMContentLoaded", function () {
    var aboutPage = document.getElementById("about-page");
    var aboutFooter = document.getElementById("about-footer");
    var videoComponent = document.getElementById("video-component");

    var pageBtn = document.getElementById("about-page-btn");
    var footerBtn = document.getElementById("about-footer-btn");
    var videoBtn = document.getElementById("video-btn");

    hideAllTablesExcept(aboutPage);

    pageBtn.addEventListener("click", function () {
      aboutPage.style.display = "block";
      hideAllTablesExcept(aboutPage);
    });

    footerBtn.addEventListener("click", function () {
      aboutFooter.style.display = "block";
      hideAllTablesExcept(aboutFooter);
    });

    videoBtn.addEventListener("click", function () {
      videoComponent.style.display = "block";
      hideAllTablesExcept(videoComponent);
    });

    function hideAllTablesExcept(exceptTable) {
      var tables = [aboutPage, aboutFooter, videoComponent];
      tables.forEach(function (table) {
        if (table !== exceptTable) {
          table.style.display = "none";
        }
      });
    }
  });

$(document).ready(function() {
  // Function to create a new input group with trash icon
  function createInputGroup(inputName, placeholder, buttonClass = 'remove-bullet', value = '') {
    const div = document.createElement("div");
    div.className = "input-group mb-2 bullet-input-group";
    
    div.innerHTML = `
      <input type="text" name="${inputName}" class="form-control" 
             placeholder="${placeholder}" value="${value}">
      <div class="input-group-append">
        <button class="btn btn-danger ${buttonClass}" type="button" 
                title="Remove this bullet">
          <i class="fa fa-trash"></i>
        </button>
      </div>
    `;
    
    return div;
  }

  // === ADD MODAL FUNCTIONALITY ===
  
  // Handle adding bullets in ADD modal - Title Bullets
  $(document).on('click', '[id^="addObjectiveModal"] .add-title-bullet', function(e) {
    e.preventDefault();
    const modal = $(this).closest('.modal');
    const modalId = modal.attr('id');
    const programId = modalId.replace('addObjectiveModal', '');
    const container = document.getElementById('titleBulletsContainer' + programId);
    
    if (container) {
      const newInputGroup = createInputGroup('title_bullets[]', 'Enter bullet');
      container.appendChild(newInputGroup);
      
      // Focus on the new input
      $(newInputGroup).find('input').focus();
    }
  });

  // Handle adding bullets in ADD modal - Target Bullets
  $(document).on('click', '[id^="addObjectiveModal"] .add-target-bullet', function(e) {
    e.preventDefault();
    const modal = $(this).closest('.modal');
    const modalId = modal.attr('id');
    const programId = modalId.replace('addObjectiveModal', '');
    const container = document.getElementById('targetBulletsContainer' + programId);
    
    if (container) {
      const newInputGroup = createInputGroup('target_bullets[]', 'Enter bullet');
      container.appendChild(newInputGroup);
      
      // Focus on the new input
      $(newInputGroup).find('input').focus();
    }
  });

  // === EDIT MODAL FUNCTIONALITY ===
  
  // Handle adding new bullets in EDIT modals - Title Bullets
  $(document).on('click', '[id^="editObjectiveModal"] .add-title-bullet', function(e) {
    e.preventDefault();
    const button = $(this);
    const targetSelector = button.data('target');
    const inputName = button.data('input-name') || 'new_title_bullets[]';
    const container = document.querySelector(targetSelector);
    
    if (container) {
      // Create a new input group with trash icon directly
      const newInputGroup = createInputGroup(inputName, 'Enter new bullet', 'remove-bullet');
      
      // Find the "add" input group (the one with the plus button)
      const addInputGroup = $(container).find('.add-input-group').last();
      
      // Insert the new input before the add input group
      if (addInputGroup.length > 0) {
        addInputGroup.before(newInputGroup);
      } else {
        // If no add input group exists, just append
        container.appendChild(newInputGroup);
      }
      
      // Focus on the new input
      $(newInputGroup).find('input').focus();
    }
  });

  // Handle adding new bullets in EDIT modals - Target Bullets  
  $(document).on('click', '[id^="editObjectiveModal"] .add-target-bullet', function(e) {
    e.preventDefault();
    const button = $(this);
    const targetSelector = button.data('target');
    const inputName = button.data('input-name') || 'new_target_bullets[]';
    const container = document.querySelector(targetSelector);
    
    if (container) {
      // Create a new input group with trash icon directly
      const newInputGroup = createInputGroup(inputName, 'Enter new bullet', 'remove-bullet');
      
      // Find the "add" input group (the one with the plus button)
      const addInputGroup = $(container).find('.add-input-group').last();
      
      // Insert the new input before the add input group
      if (addInputGroup.length > 0) {
        addInputGroup.before(newInputGroup);
      } else {
        // If no add input group exists, just append
        container.appendChild(newInputGroup);
      }
      
      // Focus on the new input
      $(newInputGroup).find('input').focus();
    }
  });

  // === REMOVE BULLET FUNCTIONALITY ===
  
  // Handle removing bullets (simplified - just remove the input)
  $(document).on('click', '.remove-bullet', function(e) {
    e.preventDefault();
    
    const inputGroup = $(this).closest('.input-group');
    
    // Show confirmation dialog
    Swal.fire({
      title: 'Remove this bullet?',
      text: "This action cannot be undone.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Yes, remove it!',
      cancelButtonText: 'Cancel'
    }).then((result) => {
      if (result.isConfirmed) {
        // Remove the input group with animation
        inputGroup.fadeOut(300, function() {
          inputGroup.remove();
        });
      }
    });
  });

  // === ENHANCED INPUT MANAGEMENT ===
  
  // Auto-focus on next input when Enter is pressed
  $(document).on('keypress', '.bullet-input-group input, .add-input-group input', function(e) {
    if (e.which === 13) { // Enter key
      e.preventDefault();
      const currentValue = $(this).val().trim();
      
      if (currentValue) {
        // If in an add-input-group, trigger the add button
        if ($(this).closest('.add-input-group').length > 0) {
          $(this).closest('.input-group').find('.btn-success').click();
        } else {
          // Focus on next input or create new one
          const nextInput = $(this).closest('.input-group').next().find('input');
          if (nextInput.length > 0) {
            nextInput.focus();
          } else {
            // Find the appropriate add button and click it
            const container = $(this).closest('[id$="Container"]');
            container.find('.btn-success').last().click();
          }
        }
      }
    }
  });

  // === FORM SUBMISSION HANDLING ===
  
  // Handle EDIT modal form submission
  $('[id^="editObjectiveModal"] form').on('submit', function(e) {
    const form = $(this);
    
    // Remove empty "add new" inputs (ones that still have the plus button)
    form.find('.add-input-group').each(function() {
      const input = $(this).find('input');
      if (!input.val().trim()) {
        $(this).remove();
      }
    });
    
    // Remove empty bullet inputs
    form.find('input[name^="existing_title_bullets"], input[name^="existing_target_bullets"], input[name^="new_title_bullets"], input[name^="new_target_bullets"]').each(function() {
      if (!$(this).val().trim()) {
        $(this).closest('.input-group').remove();
      }
    });
    
    // Show loading state
    const submitBtn = form.find('button[type="submit"]');
    const originalText = submitBtn.text();
    submitBtn.prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Saving...');
    
    // Re-enable button after a delay (in case of errors)
    setTimeout(() => {
      submitBtn.prop('disabled', false).text(originalText);
    }, 5000);
  });

  // Handle ADD modal form submission
  $('[id^="addObjectiveModal"] form').on('submit', function(e) {
    const form = $(this);
    
    // Remove empty bullet inputs
    form.find('input[name="title_bullets[]"], input[name="target_bullets[]"]').each(function() {
      if (!$(this).val().trim()) {
        $(this).closest('.input-group').remove();
      }
    });
    
    // Show loading state
    const submitBtn = form.find('button[type="submit"]');
    const originalText = submitBtn.text();
    submitBtn.prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Adding...');
    
    // Re-enable button after a delay (in case of errors)
    setTimeout(() => {
      submitBtn.prop('disabled', false).text(originalText);
    }, 5000);
  });

  // === MODAL RESET FUNCTIONALITY ===
  
  // Reset ADD modal when it's closed
  $('[id^="addObjectiveModal"]').on('hidden.bs.modal', function() {
    const modal = $(this);
    const modalId = modal.attr('id');
    const programId = modalId.replace('addObjectiveModal', '');
    
    // Reset form
    modal.find('form')[0].reset();
    
    // Remove all dynamically added inputs
    modal.find('.bullet-input-group').remove();
    
    // Reset containers to initial state
    const titleContainer = document.getElementById('titleBulletsContainer' + programId);
    const targetContainer = document.getElementById('targetBulletsContainer' + programId);
    
    if (titleContainer) {
      $(titleContainer).empty();
    }
    if (targetContainer) {
      $(targetContainer).empty();
    }
  });

  // === INITIALIZATION ===
  
  // Ensure all modals are properly initialized
  $('[id^="addObjectiveModal"], [id^="editObjectiveModal"]').each(function() {
    const modal = $(this);
    
    // Make sure modal has proper event listeners
    modal.on('show.bs.modal', function() {
      // Focus on first input when modal opens
      setTimeout(function() {
        modal.find('input[type="text"]').first().focus();
      }, 500);
    });
  });

  // === ENHANCED UI FEATURES ===
  
  // Add hover effects to input groups
  $(document).on('mouseenter', '.input-group', function() {
    $(this).addClass('shadow-sm');
  });
  
  $(document).on('mouseleave', '.input-group', function() {
    $(this).removeClass('shadow-sm');
  });

  // Add character counter for long inputs
  $(document).on('input', '.form-control', function() {
    const maxLength = 200; // Adjust as needed
    const currentLength = $(this).val().length;
    
    if (currentLength > maxLength * 0.8) {
      $(this).addClass('border-warning');
      
      // Show character count tooltip
      $(this).attr('title', `${currentLength}/${maxLength} characters`);
    } else {
      $(this).removeClass('border-warning');
      $(this).removeAttr('title');
    }
  });
});
  // Delete form confirmations (existing code)
  document.querySelectorAll('.delete-about-form').forEach(form => {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      Swal.fire({
        title: 'Delete this About Project?',
        text: "This action cannot be undone.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#aaa',
        confirmButtonText: 'Yes, delete it!',
        reverseButtons: true
      }).then((result) => {
        if (result.isConfirmed) {
          form.submit();
        }
      });
    });
  });

  document.querySelectorAll('.delete-form').forEach(form => {
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      Swal.fire({
        title: 'Are you sure?',
        text: "This action cannot be undone!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#6c757d',
        confirmButtonText: 'Yes, delete it!'
      }).then((result) => {
        if (result.isConfirmed) {
          form.submit();
        }
      });
    });
  });

  document.addEventListener("DOMContentLoaded", function () {
  const descriptionField = document.querySelector('textarea[name="description"]');

  if (descriptionField) {
    descriptionField.addEventListener("input", function () {
      const words = descriptionField.value.trim().split(/\s+/);
      if (words.length > 100) {
        // Keep only the first 100 words
        descriptionField.value = words.slice(0, 100).join(" ");
        
        // Optional: notify user (you can customize this)
        alert("Description must not exceed 100 words.");
      }
    });
  }
});
</script>
{% endblock %}
